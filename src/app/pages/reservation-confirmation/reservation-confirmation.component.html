<!-- src/app/pages/reservation-confirmation/reservation-confirmation.component.html -->

<div class="confirmation-container">
  <div *ngIf="isLoading" class="text-center">
    <div class="spinner-border text-primary" style="width: 3rem; height: 3rem;"></div>
    <p class="mt-2 lead">Loading Reservation Details...</p>
  </div>

  <div *ngIf="!isLoading" class="card confirmation-card">
    <div class="card-body text-center">

      <div *ngIf="status !== 'NOT_FOUND'">
        <i class="uil confirmation-icon"
           [ngClass]="{
             'uil-check-circle': status === 'CONFIRMED',
             'uil-times-circle cancelled': status === 'CANCELED',
             'uil-pause-circle pending': status === 'PENDING_APPROVAL'
           }"></i>

        <h2 *ngIf="status === 'CONFIRMED'" class="mt-3">Rezervimi u Konfirmua!</h2>
        <h2 *ngIf="status === 'CANCELED'" class="mt-3">Reservation Cancelled</h2>
        <h2 *ngIf="status === 'PENDING_APPROVAL'" class="mt-3">Request Received</h2>

        <p *ngIf="status === 'CONFIRMED'" class="lead">Faleminderit për rezervimin tuaj. Ju mund të shikoni detajet më poshtë.</p>
        <p *ngIf="status === 'CANCELED'" class="lead">{{ cancellationMessage || 'Your reservation has been cancelled.' }}</p>
        <p *ngIf="status === 'PENDING_APPROVAL'" class="lead">Your request is pending approval. You will be notified by email once it has been reviewed.</p>

        <div *ngIf="reservationDetails" class="confirmation-details">
          <p><strong>ID e Rezervimit:</strong> {{ reservationDetails.id }}</p>
          <p><strong>Data:</strong> {{ formattedDate }}</p>
          <p><strong>Koha:</strong> {{ formattedTime }}</p>
          <p><strong>Numri i Personave:</strong> {{ formattedGuests }}</p>
          <p><strong>Zona:</strong> {{ selectedZone }}</p>
          <p><strong>Emri:</strong> {{ fullName }}</p>
          <p><strong>Email:</strong> {{ email }}</p>
          <p><strong>Telefon:</strong> {{ phone }}</p>
          <p><strong>Kërkesa Speciale:</strong> {{ requests }}</p>
        </div>

        <div class="mt-4">
          <button *ngIf="status === 'CONFIRMED' || status === 'PENDING_APPROVAL'" class="btn btn-danger me-2" (click)="cancelReservation()">
            Cancel {{ status === 'PENDING_APPROVAL' ? 'Request' : 'Reservation' }}
          </button>
          <button class="btn btn-primary" (click)="goBack()">Kthehu në faqen kryesore</button>
        </div>
      </div>

      <div *ngIf="status === 'NOT_FOUND'">
        <i class="uil uil-exclamation-triangle confirmation-icon error"></i>
        <h2 class="mt-3">Reservation Not Found</h2>
        <p class="lead">The link you used may be invalid or expired.</p>
        <button class="btn btn-primary mt-4" (click)="goBack()">Kthehu</button>
      </div>

    </div>
  </div>
</div>
